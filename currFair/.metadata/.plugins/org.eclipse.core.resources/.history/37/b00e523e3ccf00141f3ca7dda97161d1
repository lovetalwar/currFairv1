

package com.example.currFair.api.service.impl;

import java.util.List;

import javax.ws.rs.WebApplicationException;
import javax.ws.rs.core.Response;
import javax.ws.rs.core.Response.ResponseBuilder;

import com.example.currFair.api.manager.MessageManager;
import com.example.currFair.api.model.TradeMessage;
import com.example.currFair.api.service.MessageService;
import com.example.currFair.api.util.ApiTransaction;
import com.google.inject.Inject;

/**
 * REST implementation of Message Service(I)
 * 
 */
public class MessageServiceImpl  extends AbstractServiceImpl implements MessageService
{
    @Inject
    private MessageManager messageManager;

   
    public Response consumeMessages(List<TradeMessage> tradeMessages) throws WebApplicationException
    {

        ApiTransaction transaction = transactionProvider.get().init("consumeMessages");
        
       
        messageManager.processMessages(tradeMessages);
      
        ResponseBuilder builder = Response.noContent();
        return transaction.complete(builder.build());

    }
    
    
    
    
}
