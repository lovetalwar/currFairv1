
package com.example.currFair.api.service;

import javax.annotation.security.PermitAll;
import javax.ws.rs.GET;
import javax.ws.rs.Path;
import javax.ws.rs.PathParam;
import javax.ws.rs.Produces;
import javax.ws.rs.WebApplicationException;
import javax.ws.rs.core.MediaType;
import javax.ws.rs.core.Response;

import org.jboss.resteasy.annotations.cache.Cache;
import org.jboss.resteasy.spi.validation.ValidateRequest;

import com.londonhydro.model.RateCategory;
import com.londonhydro.model.RateCategoryInfo;
import com.londonhydro.utils.atom.links.LHLinkResource;

/**
 * Rate service for receiving information related to water/electricity rates
 * 
 * @author Vadim Pinchevski (vpinchevski@affsys.com)
 */
@Path("/v1/rates")
@ValidateRequest
public interface RateService
{
    
    /**
     * Get all the rate categories
     * 
     * @param type Rate type - water or electricity
     * 
     * @HTTP 201 - OK
     * @HTTP 404 - WRONG
     * 
     * @return List of <code>RateCategoryInfo</code> objects
     * @throws WebApplicationException - Service Exception / Runtime Exception
     */
    @Cache(maxAge = 900, mustRevalidate = true) // 5 minutes
    @PermitAll
    @GET
    @Produces(MediaType.APPLICATION_JSON)
    public Response getAllRateCategories() throws WebApplicationException;
    
    /**
     * Get the rate category info based on the type
     * 
     * @param type Rate type - water or electricity
     * 
     * @HTTP 201 - OK
     * @HTTP 404 - WRONG
     * 
     * @return List of <code>RateCategoryInfo</code> objects
     * @throws WebApplicationException - Service Exception / Runtime Exception
     */
    @Cache(maxAge = 900, mustRevalidate = true) // 5 minutes
    @PermitAll
    @GET
    @Path("/{type: (water)|(electricity)|(residential)|(commercial)|\\d+}")
    @Produces(MediaType.APPLICATION_JSON)
    public Response getRateCategoryInfo(@PathParam("type") String type) throws WebApplicationException;
    
    /**
     * Get the electricity rate category
     * 
     * 
     * @param rateType Rate category type
     * 
     * @HTTP 201 - OK
     * @HTTP 404 - WRONG
     * 
     * @return <code>RateCategory</code> object
     * @throws WebApplicationException - Service Exception / Runtime Exception
     */
    @Cache(maxAge = 900, mustRevalidate = true) // 5 minutes
    @PermitAll
    @LHLinkResource(value = RateCategory.class)
    @GET
    @Path("/electricity/{rateType: (residential)|(lessthan50kw)|(greaterthan50kwnoim)|(greaterthan50kwwithim)|(largeuser)|\\d}")
    @Produces(MediaType.APPLICATION_JSON)
    public Response getElectricityRateCategory(@PathParam("rateType") String rateType) throws WebApplicationException;

    /**
     * Get the water rate category based
     * 
     * @HTTP 201 - OK
     * @HTTP 404 - WRONG
     * 
     * @return <code>RateCategory</code> object
     * @throws WebApplicationException - Service Exception / Runtime Exception
     */
    @Cache(maxAge = 900, mustRevalidate = true) // 5 minutes
    @PermitAll
    @LHLinkResource(value = RateCategory.class)
    @GET
    @Path("/water/{type: (residential)|(commercial)}")
    @Produces(MediaType.APPLICATION_JSON)
    public Response getWaterRateCategory(@PathParam("type") String type) throws WebApplicationException;
    
    
    /**
     * Get water tier rates
     * 
     * 
     * @HTTP 201 - OK
     * @HTTP 404 - WRONG
     * 
     * @return List of <code>RateCategoryInfo</code> objects
     * @throws WebApplicationException - Service Exception / Runtime Exception
     */
    @Cache(maxAge = 900, mustRevalidate = true) // 5 minutes
    @PermitAll
    @GET
    @Path("/waterTier")
    @Produces(MediaType.APPLICATION_JSON)
    public Response getWaterTierRates() throws WebApplicationException;
    
}
